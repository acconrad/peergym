<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="<%= render_existing view_module(@conn), "meta_description", assigns %>.">

    <title><%= render_existing view_module(@conn), "title", assigns %> - PeerGym</title>

    <link rel="icon" href="/favicon.ico">

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" data-no-reload>
    <link rel="stylesheet" href="<%= static_path(@conn, "/css/app.css") %>">
  </head>

  <body class="<%= body_class @conn %>">
    <header class="navbar navbar-default navbar-static-top">
      <div class="fluid-container">
        <div class="navbar-header">
          <%= link to: gym_path(@conn, :index), class: "navbar-brand" do %>
            <span class="logo">Peer<strong>Gym</strong></span>
          <% end %>

          <%= form_for @conn, gym_path(@conn, :index), [class: "navbar-form form-gym-search", role: "search", as: :search, method: "get"], fn f -> %>
            <%= hidden_input f, :lng %>
            <%= hidden_input f, :lat %>
            <%= hidden_input f, :place %>
            <%= hidden_input f, :city %>
            <%= hidden_input f, :state %>

            <div class="form-control-w-icon">
              <i class="fa fa-search"></i>
              <%= text_input f, :location, class: "form-control form-gym-location", placeholder: "Find a gym…", value: form_location_prefill(assigns) %>
            </div>
          <% end %>
        </div>
      </div>
    </header>

    <p class="alert alert-info" role="alert"><%= get_flash(@conn, :info) %></p>
    <p class="alert alert-danger" role="alert"><%= get_flash(@conn, :error) %></p>

    <ul class="nav-auth">
      <%= if logged_in?(@conn) do %>
        <li><a><%= current_user(@conn).email %></a></li>
        <li><%= link "Sign Out", to: session_path(@conn, :delete) %></li>
      <% else %>
        <li><%= link "Sign Up", to: user_path(@conn, :new) %></li>
        <li><%= link "Sign In", to: session_path(@conn, :new) %></li>
      <% end %>
      <li><a><small>© 2015 PeerGym. All rights reserved.</small></a></li>
    </ul>

    <input type="checkbox" id="nav-trigger" class="nav-trigger">
    <label for="nav-trigger">
      <i class="fa fa-user"></i>
    </label>

    <main class="fluid-container">
      <%= render @view_module, @view_template, assigns %>
    </main>

    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true&libraries=places"></script>
    <script src="<%= static_path(@conn, "/js/app.js") %>"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-71791093-1', 'auto');
      ga('send', 'pageview');
    </script>
    <script src="//load.sumome.com/" data-sumo-site-id="67571afbf2c3be5b4a065abf8a9b77d2ab4e408790994f11b3337e45a1cc6b01" async="async"></script>
  </body>
</html>
